CREATE TABLE amji_emoticones (idamji_emoticones INT AUTO_INCREMENT, racourci VARCHAR(100) NOT NULL, image VARCHAR(200) NOT NULL, PRIMARY KEY(idamji_emoticones)) ENGINE = INNODB;
CREATE TABLE amji_file (idamji_file INT AUTO_INCREMENT, content LONGBLOB NOT NULL, PRIMARY KEY(idamji_file)) ENGINE = INNODB;
CREATE TABLE amji_invitation (idamji_user INT, idamji_invite INT, message TEXT NOT NULL, PRIMARY KEY(idamji_user, idamji_invite)) ENGINE = INNODB;
CREATE TABLE amji_priorite (idamji_priorite INT AUTO_INCREMENT, libelle VARCHAR(100) NOT NULL, PRIMARY KEY(idamji_priorite)) ENGINE = INNODB;
CREATE TABLE amji_request (idamji_request INT AUTO_INCREMENT, title TEXT NOT NULL, content TEXT NOT NULL, iduser INT NOT NULL, idpriorite INT NOT NULL, idtype INT NOT NULL, INDEX iduser_idx (iduser), INDEX idpriorite_idx (idpriorite), INDEX idtype_idx (idtype), PRIMARY KEY(idamji_request)) ENGINE = INNODB;
CREATE TABLE amji_request_attachment (idamji_file INT, idamji_request INT, PRIMARY KEY(idamji_file, idamji_request)) ENGINE = INNODB;
CREATE TABLE amji_response (idamji_response INT AUTO_INCREMENT, content TEXT NOT NULL, iduser INT NOT NULL, idrequest INT NOT NULL, idresponse INT, INDEX iduser_idx (iduser), INDEX idrequest_idx (idrequest), PRIMARY KEY(idamji_response)) ENGINE = INNODB;
CREATE TABLE amji_response_attachment (idamji_response INT, idamji_file INT, PRIMARY KEY(idamji_response, idamji_file)) ENGINE = INNODB;
CREATE TABLE amji_statut (idamji_statut INT, libelle VARCHAR(100) NOT NULL, PRIMARY KEY(idamji_statut)) ENGINE = INNODB;
CREATE TABLE amji_subscribe (idamji_user INT, idamji_type INT, PRIMARY KEY(idamji_user, idamji_type)) ENGINE = INNODB;
CREATE TABLE amji_type (idamji_type INT AUTO_INCREMENT, libelle VARCHAR(100) NOT NULL, PRIMARY KEY(idamji_type)) ENGINE = INNODB;
CREATE TABLE amji_user (idamji_user INT AUTO_INCREMENT, pseudo VARCHAR(100) NOT NULL, email VARCHAR(100) NOT NULL, nom VARCHAR(100) NOT NULL, prenom VARCHAR(100) NOT NULL, adr VARCHAR(100), tel VARCHAR(100), etudiant TINYINT, ecole VARCHAR(100), niveau VARCHAR(100), salarie TINYINT, statut VARCHAR(100), societe VARCHAR(100), idamji_statut INT, INDEX idamji_statut_idx (idamji_statut), PRIMARY KEY(idamji_user)) ENGINE = INNODB;
CREATE TABLE sf_guard_group (id INT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_group_permission (group_id INT, permission_id INT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(group_id, permission_id)) ENGINE = INNODB;
CREATE TABLE sf_guard_permission (id INT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_remember_key (id INT AUTO_INCREMENT, user_id INT, remember_key VARCHAR(32), ip_address VARCHAR(50), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id, ip_address)) ENGINE = INNODB;
CREATE TABLE sf_guard_user (id INT AUTO_INCREMENT, username VARCHAR(128) NOT NULL UNIQUE, algorithm VARCHAR(128) DEFAULT 'sha1' NOT NULL, salt VARCHAR(128), password VARCHAR(128), is_active TINYINT(1) DEFAULT '1', is_super_admin TINYINT(1) DEFAULT '0', last_login DATETIME, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX is_active_idx_idx (is_active), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_user_group (user_id INT, group_id INT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, group_id)) ENGINE = INNODB;
CREATE TABLE sf_guard_user_permission (user_id INT, permission_id INT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, permission_id)) ENGINE = INNODB;
ALTER TABLE amji_request ADD CONSTRAINT amji_request_iduser_amji_user_idamji_user FOREIGN KEY (iduser) REFERENCES amji_user(idamji_user);
ALTER TABLE amji_request ADD CONSTRAINT amji_request_idtype_amji_type_idamji_type FOREIGN KEY (idtype) REFERENCES amji_type(idamji_type);
ALTER TABLE amji_request ADD CONSTRAINT amji_request_idpriorite_amji_priorite_idamji_priorite FOREIGN KEY (idpriorite) REFERENCES amji_priorite(idamji_priorite);
ALTER TABLE amji_response ADD CONSTRAINT amji_response_iduser_amji_user_idamji_user FOREIGN KEY (iduser) REFERENCES amji_user(idamji_user);
ALTER TABLE amji_response ADD CONSTRAINT amji_response_idrequest_amji_request_idamji_request FOREIGN KEY (idrequest) REFERENCES amji_request(idamji_request);
ALTER TABLE amji_user ADD CONSTRAINT amji_user_idamji_statut_amji_statut_idamji_statut FOREIGN KEY (idamji_statut) REFERENCES amji_statut(idamji_statut);
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_remember_key ADD CONSTRAINT sf_guard_remember_key_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
