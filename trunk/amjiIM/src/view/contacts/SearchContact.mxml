<?xml version="1.0" encoding="utf-8"?>
<mx:Window xmlns:mx="http://www.adobe.com/2006/mxml"
	backgroundAlpha="0"
    showTitleBar="false"
    showStatusBar="false"
    showGripper="false"
    borderStyle="none" 
    xmlns:components="commun.components.*"   
    horizontalAlign="center"
    width="400"
    height="300"
    creationComplete="init()">
	<mx:Script>
		<![CDATA[
			import mx.controls.Alert;
			import mx.controls.listClasses.IListItemRenderer;
			import commun.Commun;
			import mx.collections.ArrayCollection;
			import commun.Actions;
			[Bindable]
			public var listeContactSearch : ArrayCollection;
			private function init():void{
    			nativeWindow.x = (Capabilities.screenResolutionX - nativeWindow.width) / 2;
                nativeWindow.y = (Capabilities.screenResolutionY - nativeWindow.height) / 2; 
                Commun.addChildrenToMenu(popupMenu,menuDefinition.children()); 
                popupMenu.addEventListener(Event.SELECT, onChoice); 
             								   			
    		}
    		
    		public function onChoice(event : Event):void{
    			var menuItem = event.target; 
				if(menuItem.label == "Ajouter")
					addContactViewStack.selectedIndex = 1;
    		}
    		public var popupMenu : NativeMenu = new NativeMenu;
    		
    		public function showPopupMenu(event : MouseEvent):void{
    			var rightClickItemRenderer:IListItemRenderer;
                
                if (event.target is IListItemRenderer)
                    rightClickItemRenderer = IListItemRenderer(event.target);
                else if (event.target.parent is IListItemRenderer)
                    rightClickItemRenderer = 
                        IListItemRenderer(event.target.parent);
                
                if (rightClickItemRenderer != null)
                {
                    var rightClickIndex:int = 
                        listContact.itemRendererToIndex(rightClickItemRenderer);
                    
                    if (listContact.selectedIndex != rightClickIndex){                    	
                        listContact.selectedIndex = rightClickIndex;
                    }
                    if(listContact.selectedIndex>0)
   						popupMenu.display(event.target.stage, event.stageX, event.stageY);                     
                }
    			
    		}
    		
    		var menuDefinition:XML = 
			    <root> 
			        <AddContact key="inviteContact" label='Ajouter'/>			            
			        <SendPost key="" label='Envoyer un post'/>			        
			    </root>;
		]]>
	</mx:Script>
	<mx:ViewStack id="addContactViewStack" width="100%" height="100%">	
		<mx:VBox styleName="loginScalingBackground" dropShadowEnabled="true" width="100%" height="100%" horizontalAlign="center">
			<mx:HBox width="100%" height="15" horizontalAlign="right" paddingRight="15">
			    <components:WindowMin width="9" height="9" buttonMode="true" useHandCursor="true" />
				<components:WindowMax  width="9" height="9" buttonMode="true" useHandCursor="true" />
				<components:WindowClose click="this.close();dispatchEvent(new Event(Actions.CLOSEINSCWIN))" width="9" height="9" buttonMode="true" useHandCursor="true" />			
			</mx:HBox>
			<mx:HBox width="100%" height="100%" horizontalAlign="center">
				<mx:TextInput id="txtCritere" />
				<components:AmjiOrangeButton click="dispatchEvent(new Event(Actions.SEARCHCONTACT))" color="#FFFFFF" width="100" height="25" label="rechercher" />
			</mx:HBox>
			<mx:VBox paddingBottom="20" paddingLeft="10" paddingRight="10" width="100%">
				<mx:List id="listContact" rightClick="showPopupMenu(event)" labelField="nom" width="100%" height="100%" dataProvider="{listeContactSearch}">
				
				</mx:List>	
			</mx:VBox>
			
		</mx:VBox>
		<mx:VBox styleName="loginScalingBackground" dropShadowEnabled="true" width="100%" height="100%" horizontalAlign="center">
			<mx:HBox width="100%" height="15" horizontalAlign="right" paddingRight="15">
			    <components:WindowMin width="9" height="9" buttonMode="true" useHandCursor="true" />
				<components:WindowMax  width="9" height="9" buttonMode="true" useHandCursor="true" />
				<components:WindowClose click="this.close();dispatchEvent(new Event(Actions.CLOSEINSCWIN))" width="9" height="9" buttonMode="true" useHandCursor="true" />			
			</mx:HBox>
			<mx:TextArea width="100%" height="100%" id="txtMsgInvit">
				
			</mx:TextArea>
			<components:AmjiOrangeButton click="dispatchEvent(new Event(Actions.ADDCONTACT))" color="#FFFFFF" width="100" height="25" label="envoyer" />	
		</mx:VBox>
	</mx:ViewStack>
</mx:Window>
