<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute"
	backgroundAlpha="0"
    showTitleBar="false"
    showStatusBar="false"
    showGripper="false"
    borderStyle="none"
    applicationComplete="init()" xmlns:components="commun.components.*"
    close="closeHandler()"
    width="100%" height="100%">
	
	<mx:Script>
		<![CDATA[
			import model.vo.CreateUserVO;
			import view.InscriptionWindow;
			import commun.Actions;
			import com.bedreamy.facade.MainFacade;
			import mx.controls.Alert;
			import view.LoginWindow;
			private var facade:ApplicationFacade = ApplicationFacade.getInstance();
			private var bedreamy:MainFacade = MainFacade.getInstance();
			public var window:LoginWindow;
			private function init():void{
				facade.startup(this);
				this.addEventListener(NativeWindowDisplayStateEvent.DISPLAY_STATE_CHANGE,handleChangeState);						
				openLoginWindow();
				bedreamy.mainapplication = this;	
							
			}
			
			private function handleChangeState(event:NativeWindowDisplayStateEvent):void{
				if(event.afterDisplayState == NativeWindowDisplayState.MINIMIZED){ 
					window.orderToBack();						
				}else if(event.afterDisplayState == NativeWindowDisplayState.NORMAL){
					window.orderToFront();					
				} 
			}
			
			private function openLoginWindow():void{
				window = new LoginWindow();				
				window.type = NativeWindowType.LIGHTWEIGHT;
				window.systemChrome = "none";
				window.transparent = true;	
														
				window.open();
				window.addEventListener(Actions.SHOWUSERUI,createUser);
				window.addEventListener(Actions.CLOSEAPPLI,closeAppli);
				
			}
			
			public function closeInscWin(event : Event):void{
				inscWindow.nativeWindow.visible = false;				
				window.nativeWindow.visible = true;
			}
			public var inscWindow : InscriptionWindow ;
			public function createUser(event : Event):void{
				inscWindow = new InscriptionWindow;
				inscWindow.type = NativeWindowType.LIGHTWEIGHT;
				inscWindow.systemChrome = "none";
				inscWindow.transparent = true;	
				inscWindow.open();				
				inscWindow.addEventListener(Actions.CLOSEINSCWIN,closeInscWin);
				inscWindow.createUserVO = new CreateUserVO();				
				window.nativeWindow.visible = false;
				window.closePopupExt();				
			}
			
			public function closeAppli(e:Event):void{
				this.close();
			}
			private function closeHandler():void{
				if(window!=null)
					window.close();
			}
		]]>
	</mx:Script>
	<mx:Style source="AmjiTheme.css"/>
	<!--<mx:VBox width="100%" height="100%" backgroundColor="#FFFFFF">
	<mx:Spacer height="1.2" />
		<mx:HBox width="100%" horizontalGap="0" horizontalAlign="right">			
			<components:WindowMin label="" width="43" height="27.5" useHandCursor="true" buttonMode="true"/>
			<components:WindowMax label="" width="43" height="27.5" useHandCursor="true" buttonMode="true"/>
			<components:WindowClose label="" width="43" height="27.5" useHandCursor="true" buttonMode="true" click="this.close();"/>
			<mx:Spacer width="18" /> 	
		</mx:HBox>
			
	</mx:VBox>-->
	
</mx:WindowedApplication>

